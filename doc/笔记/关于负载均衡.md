## 负载均衡
集群中的应用服务器（节点）通常被设计成无状态，用户可以请求任何一个节点。
负载均衡器会根据集群中每个节点的负载情况，将用户请求转发到合适的节点上。
负载均衡器可以用来实现高可用以及伸缩性：
高可用：当某个节点故障时，负载均衡器会将用户请求转发到另外的节点上，从而保证所有服务持续可用；
伸缩性：根据系统整体负载情况，可以很容易地添加或移除节点。
负载均衡器运行过程包含两个部分：
(1)根据负载均衡算法得到转发的节点；
(2)进行转发。
## 负载均衡算法
 ### 轮询(Round Robin)
    一共有 6 个客户端产生了 6 个请求，这 6 个请求按 (1, 2, 3, 4, 5, 6) 的顺序发送。
    (1, 3, 5) 的请求会被发送到服务器 1，(2, 4, 6) 的请求会被发送到服务器 2。
    该算法比较适合每个服务器的性能差不多的场景，如果有性能存在差异的情况下，那么性能较差的服务器可能无法承担过大的负载
 ### 加权轮询（Weighted Round Robbin）
     服务器 1 被赋予的权值为 5，服务器 2 被赋予的权值为 1，
     那么 (1, 2, 3, 4, 5) 请求会被发送到服务器 1，(6) 请求会被发送到服务器 2。
 ### 最少连接（least Connections）
     由于每个请求的连接时间不一样，使用轮询或者加权轮询算法的话，
     可能会让一台服务器当前连接数过大，而另一台服务器的连接过小，造成负载不均衡。
     for example:
     (1, 3, 5) 请求会被发送到服务器 1，但是 (1, 3) 很快就断开连接，
     此时只有 (5) 请求连接服务器 1；(2, 4, 6) 请求被发送到服务器 2，只有 (2) 的连接断开，
     此时 (6, 4) 请求连接服务器 2。该系统继续运行时，服务器 2 会承担过大的负载。
     最少连接算法就是将请求发送给当前最少连接数的服务器上。
     服务器 1 当前连接数最小，那么新到来的请求 6 就会被发送到服务器 1 上。
 ### 加权最少连接（Weighted Least Connection）
     在最少连接的基础上，根据服务器的性能为每台服务器分配权重，
     再根据权重计算出每台服务器能处理的连接数。
 ### 随机算法（Random）
     把请求随机发送到服务器上。
     和轮询算法类似，该算法比较适合服务器性能差不多的场景。
 ### 源地址哈希法 (IP Hash)
     源地址哈希通过对客户端 IP 计算哈希值之后，再对服务器数量取模得到目标服务器的序号。
     可以保证同一 IP 的客户端的请求会转发到同一台服务器上，用来实现会话粘滞（Sticky Session）
## 转发实现
 ### HTTP 重定向
 ### DNS 域名解析
 ### 反向代理服务器
 ### 网络层
 ### 链路层
